{% extends 'base.html' %}

{% block title %}Daily Values – Select Company{% endblock %}

{% block content %}
<div class="card">
    <div class="toolbar">
        <div>
            <div class="hint">Pick a company to browse daily values.</div>
            {% if total is not none %}
            <div class="cik-note">Showing {{ cards|length }} of {{ total }}.</div>
            {% endif %}
        </div>
        <div><a class="button" href="/">Home</a></div>
    </div>

    {% if message %}
    <div class="warn">{{ message }}</div>
    {% endif %}

    {% if total == 0 %}
    <div class="empty" style="margin-top: .75rem;">
        No companies found yet. Populate the database and refresh this page.
    </div>
    {% endif %}

    <div id="cik-grid" class="cik-grid">
        {% for c in cards %}
        <details class="cik-card" data-cik-card="1" data-entity-id="{{ c.entity_id }}" data-cik="{{ c.cik }}">
            <summary class="cik-card__summary">
                <div class="cik-card__header" style="margin-bottom: 0;">
                    <div class="cik-card__title">{{ c.company_name or 'Company' }}</div>
                    <div class="cik-card__cik">ID {{ c.entity_id }}</div>
                </div>
            </summary>

            <div class="cik-card__expanded">
                <div class="meta" style="margin: .5rem 0 .75rem 0;">
                    <strong>Company:</strong> {{ c.cik }}
                </div>

                <dl class="cik-card__dl">
                    {% for k, v in c.metadata.items() %}
                    <dt>{{ k }}</dt>
                    <dd>{{ v if v is not none and v != '' else '—' }}</dd>
                    {% endfor %}
                </dl>

                <div class="cik-card__footer">
                    <a class="button" href="/daily-values?entity_id={{ c.entity_id }}">Open daily values</a>
                </div>
            </div>
        </details>
        {% endfor %}
    </div>

    {% if has_more %}
    <div class="cik-actions">
        <button id="load-more" data-offset="{{ next_offset }}" data-limit="{{ limit }}">Load more</button>
    </div>
    {% endif %}
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/check_cik_cards.js') }}"></script>
{% endblock %}